# 🚀 LoadLensAI

> 실시간 과적 차량 단속 솔루션

<br>

## 📖 목차

1. [프로젝트 소개](#-프로젝트-소개)
2. [주요 기능](#-주요-기능)
3. [미리보기](#%EF%B8%8F-미리보기)
4. [사용 기술](#%EF%B8%8F-사용-기술)
5. [설치 및 실행 방법](#%EF%B8%8F-설치-및-실행-방법)
6. [트러블 슈팅](#%E2%80%8D%E2%80%8D%E2%80%8D-팀원-소개)
   
<br>

## 📌 프로젝트 소개

모바일 온디바이스(On-device) AI를 활용하여 실시간으로 과적 차량을 탐지하는 안드로이드 애플리케이션입니다.
서버 통신 없이 스마트폰 자체 성능만으로 트럭의 과적 여부를 판별하여, 단속 현장에서의 효율성과 안전을 높이는 것을 목표로 합니다.

<br>

## ✨ 주요 기능

- **실시간 탐지:** 카메라 프리뷰 화면에서 즉각적인 객체 인식 (30fps 이상)  
- **과적 분류:** 차종과 과적 여부를 결합한 6가지 클래스 판별
- **오프라인 작동:** 인터넷 연결 없이 스마트폰 자체(On-device)에서 독립적으로 수행

<br>

## 🖼️ 미리보기
공사중

<br>

## 🛠️ 사용 기술

- **AI Model:** YOLOv8 (Trained on Custom Dataset -> .tflite Quantization)
- **Mobile:** Android (Kotlin), CameraX
- **Inference:** TensorFlow Lite (GPU Delegate)
- **Environment:** Python 3.9, Android Studio
<br>

## ⚙️ 설치 및 실행 방법

```bash
# 1. 이 저장소를 클론합니다.
# 2. Android Studio (Iguana 이상)에서 프로젝트를 엽니다.
# 3. Android 기기를 연결하고 실행합니다. (Min SDK: 26)
```

<br>

## 🚧 시행착오 및 모델 선정 과정 (Development Journey)

### 1단계: 이미지 분류(Classification) 접근과 실패
* **시도 (Attempt):** 초기에는 이미지 전체를 보고 과적 여부만 판단하면 된다고 생각하여, 가볍고 성능이 좋은 **EfficientNet** 모델을 사용하여 이진 분류(Binary Classification)를 시도했습니다.
* **문제 (Problem):** 학습 정확도가 오르지 않고, 모델이 트럭의 적재함이 아닌 배경(도로, 하늘, 가드레일)을 보고 판단하는 **과적합(Overfitting)** 현상이 발견되었습니다.

### 2단계: 차종별 세분화 (Hierarchical Classification) 시도
* **가설 (Hypothesis):** "소형, 중형, 대형 트럭의 생김새가 너무 다르니, 이걸 먼저 나누고 학습시키면 정확도가 오르지 않을까?"라고 판단했습니다.
* **시도 (Attempt):** 소형/중형/대형 분류 모델을 먼저 거친 뒤, 각각의 과적 판별 모델로 넘어가는 파이프라인을 구축했습니다.
* **결과 (Result):** 여전히 특정 차종에서 '적재함'이 아닌 엉뚱한 특징을 잡는 문제가 해결되지 않았고, 추론 단계가 늘어나며 속도만 느려지는 한계에 봉착했습니다.

### 3단계: 데이터 분석 및 원인 규명
* **분석 (Analysis):** 실패 원인을 찾기 위해 학습 데이터를 시각화하여 뜯어본 결과, **"이미지 내에서 트럭이 차지하는 비중이 너무 작거나, 위치가 제각각"**인 것이 근본 원인임을 깨달았습니다.
* **인사이트 (Insight):** 단순 '분류(Classification)'가 아니라, 트럭의 위치를 정확히 찾아내어 배경 노이즈를 잘라내는 **'객체 탐지(Object Detection)'** 기술이 필수적이라는 결론을 내렸습니다.

### 4단계: YOLOv8 도입 및 최종 해결
* **해결 (Solution):** 객체의 위치(Bounding Box)를 찾음과 동시에 클래스를 분류할 수 있는 **YOLOv8** 모델로 기술 스택을 전면 교체했습니다.
* **성과 (Outcome):**
    1.  모델이 정확히 '트럭 영역'에만 집중하게 되어 배경 노이즈 문제 해결.
    2.  소형/중형/대형 및 과적 여부를 한 번의 추론(One-stage)으로 처리하여 속도와 정확도 두 마리 토끼를 모두 잡음.

### 5단계: 데이터 특성에 맞춘 하이퍼파라미터 튜닝 (Data-Centric Tuning)
* **문제 (Problem):** YOLOv8의 기본 증강(Augmentation) 설정 중, `shear`(전단 변환)나 `hsv`(색상 변환) 값이 높게 설정되어 있어, 트럭의 적재함 라인이 왜곡되거나 과적 여부를 판단하는 미세한 특징이 사라지는 현상 발생.
* **접근 (Approach):** 모델 아키텍처 파라미터(Learning Rate 등)는 YOLO의 Auto-anchor 및 기본 최적화 값을 신뢰하되, **데이터 증강 하이퍼파라미터**를 커스텀하여 학습 효율을 극대화함.
* **튜닝 상세 (Details):**
  * **Mosaic (1.0 → 1.0):** 작은 객체 탐지 성능을 높이기 위해 Mosaic 확률은 최대로 유지.
  * **Mixup (0.0 → 0.1):** 과적/정상 차량의 데이터 불균형 해소를 위해 Mixup을 소폭 적용하여 일반화 성능 강화.
  * **Degrees (0.0 → 0.0):** 트럭은 주로 수평으로 주행하므로, 불필요한 회전(Rotation)을 0으로 고정하여 학습 혼란 방지.
  * **Input Size (640):** 모바일 추론 속도와 작은 적재함 특징 식별의 균형점인 640px 해상도 채택.
